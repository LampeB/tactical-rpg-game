[gd_scene load_steps=8 format=3 uid="uid://beh8655yipmht"]

[ext_resource type="Script" path="res://scenes/world/overworld.gd" id="1"]
[ext_resource type="Script" path="res://scenes/world/overworld_player.gd" id="2"]
[ext_resource type="Script" path="res://scenes/world/fast_travel_menu.gd" id="3"]
[ext_resource type="PackedScene" path="res://scenes/world/location_marker.tscn" id="4"]
[ext_resource type="Resource" path="res://data/locations/town_start.tres" id="5"]
[ext_resource type="Resource" path="res://data/locations/dungeon_cave.tres" id="6"]
[ext_resource type="PackedScene" path="res://scenes/world/roaming_enemy.tscn" id="7"]
[ext_resource type="Resource" path="res://data/encounters/encounter_slimes.tres" id="8"]
[ext_resource type="Resource" path="res://data/encounters/encounter_goblins.tres" id="9"]
[ext_resource type="Resource" path="res://data/encounters/encounter_minotaur.tres" id="16"]
[ext_resource type="PackedScene" path="res://scenes/shared/environment_3d.tscn" id="10_env"]
[ext_resource type="Script" path="res://scripts/systems/camera/orbit_camera.gd" id="11_cam"]
[ext_resource type="PackedScene" path="res://scenes/world/npc_marker.tscn" id="18"]

[sub_resource type="BoxShape3D" id="player_collision"]
size = Vector3(0.8, 1.8, 0.8)

[sub_resource type="SphereShape3D" id="interaction_sphere"]
radius = 1.5


[node name="Overworld" type="Node3D"]
script = ExtResource("1")

[node name="Environment3D" parent="." instance=ExtResource("10_env")]

[node name="LocationMarkers" type="Node3D" parent="."]

[node name="TownMarker" parent="LocationMarkers" instance=ExtResource("4")]
position = Vector3(9, 0, 6)
location_data = ExtResource("5")

[node name="CaveMarker" parent="LocationMarkers" instance=ExtResource("4")]
position = Vector3(38, 0, 20)
location_data = ExtResource("6")

[node name="Enemies" type="Node3D" parent="."]

[node name="Slime1" parent="Enemies" instance=ExtResource("7")]
position = Vector3(19, 0, 12)
encounter_data = ExtResource("8")

[node name="Slime2" parent="Enemies" instance=ExtResource("7")]
position = Vector3(25, 0, 19)
encounter_data = ExtResource("8")

[node name="Goblin1" parent="Enemies" instance=ExtResource("7")]
position = Vector3(16, 0, 22)
encounter_data = ExtResource("9")

[node name="Goblin2" parent="Enemies" instance=ExtResource("7")]
position = Vector3(34, 0, 12)
encounter_data = ExtResource("9")

[node name="Slime3" parent="Enemies" instance=ExtResource("7")]
position = Vector3(41, 0, 22)
encounter_data = ExtResource("8")

[node name="Minotaur" parent="Enemies" instance=ExtResource("7")]
position = Vector3(30, 0, 11)
encounter_data = ExtResource("16")

[node name="Player" type="CharacterBody3D" parent="."]
position = Vector3(30, 0, 17)
collision_layer = 2
collision_mask = 1
script = ExtResource("2")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.9, 0)
shape = SubResource("player_collision")

[node name="InteractionArea" type="Area3D" parent="Player"]
collision_layer = 0
collision_mask = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player/InteractionArea"]
shape = SubResource("interaction_sphere")

[node name="OrbitCamera" type="Node3D" parent="."]
script = ExtResource("11_cam")

[node name="PitchNode" type="Node3D" parent="OrbitCamera"]

[node name="Camera3D" type="Camera3D" parent="OrbitCamera/PitchNode"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 20)

[node name="Blacksmith" parent="." instance=ExtResource("18")]
position = Vector3(18, 0, 10)
npc_id = "blacksmith"

[node name="Merchant" parent="." instance=ExtResource("18")]
position = Vector3(9, 0, 10)
npc_id = "merchant"

[node name="Weaver" parent="." instance=ExtResource("18")]
position = Vector3(13, 0, 15)
npc_id = "weaver"

[node name="Doctor" parent="." instance=ExtResource("18")]
position = Vector3(13, 0, 10)
npc_id = "doctor"

[node name="UI" type="CanvasLayer" parent="."]

[node name="HUD" type="Control" parent="UI"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="GoldLabel" type="Label" parent="UI/HUD"]
layout_mode = 1
anchors_preset = 0
offset_left = 16.0
offset_top = 16.0
offset_right = 200.0
offset_bottom = 40.0
theme_override_font_sizes/font_size = 20
text = "Gold: 0"

[node name="LocationLabel" type="Label" parent="UI/HUD"]
layout_mode = 1
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -200.0
offset_top = -60.0
offset_right = 200.0
offset_bottom = -30.0
theme_override_font_sizes/font_size = 20
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 4
horizontal_alignment = 1

[node name="InfoLabel" type="Label" parent="UI/HUD"]
layout_mode = 1
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -300.0
offset_top = 16.0
offset_right = 300.0
offset_bottom = 40.0
theme_override_font_sizes/font_size = 18
horizontal_alignment = 1

[node name="FastTravelMenu" type="PanelContainer" parent="UI"]
visible = false
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -200.0
offset_top = -150.0
offset_right = 200.0
offset_bottom = 150.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("3")

[node name="MarginContainer" type="MarginContainer" parent="UI/FastTravelMenu"]
layout_mode = 2
theme_override_constants/margin_left = 16
theme_override_constants/margin_top = 16
theme_override_constants/margin_right = 16
theme_override_constants/margin_bottom = 16

[node name="VBoxContainer" type="VBoxContainer" parent="UI/FastTravelMenu/MarginContainer"]
layout_mode = 2
theme_override_constants/separation = 8

[node name="Title" type="Label" parent="UI/FastTravelMenu/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 22
text = "Fast Travel"
horizontal_alignment = 1

[node name="LocationList" type="ItemList" parent="UI/FastTravelMenu/MarginContainer/VBoxContainer"]
layout_mode = 2
custom_minimum_size = Vector2(0, 150)

[node name="Buttons" type="HBoxContainer" parent="UI/FastTravelMenu/MarginContainer/VBoxContainer"]
layout_mode = 2
alignment = 1

[node name="ConfirmButton" type="Button" parent="UI/FastTravelMenu/MarginContainer/VBoxContainer/Buttons"]
layout_mode = 2
custom_minimum_size = Vector2(100, 0)
text = "Travel"

[node name="CancelButton" type="Button" parent="UI/FastTravelMenu/MarginContainer/VBoxContainer/Buttons"]
layout_mode = 2
custom_minimum_size = Vector2(100, 0)
text = "Cancel"
